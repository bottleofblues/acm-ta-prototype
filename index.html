<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Paul Bickford Solutions • Advanced Career Mastery — TA</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 2rem; line-height: 1.45; }
    .card { border: 1px solid #ddd; border-radius: 12px; padding: 1rem 1.25rem; margin-bottom: 1rem; }
    .row { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1rem; }
    label { display: block; font-weight: 600; margin-top: 0.5rem; }
    input, textarea { width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 8px; }
    small { color: #555; }

    /* Shared buttons */
    .btn {
      display: inline-block;
      padding: 0.65rem 1rem;
      border-radius: 10px;
      border: 1px solid #333;
      background: #111;
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none; /* in case applied to anchors anywhere */
    }
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .btn-secondary {
      background: #fff;
      color: #111;
      border: 1px solid #333;
    }
    .stack { display: flex; flex-wrap: wrap; gap: .5rem; }

    .muted { color: #666; font-size: .95rem; }
    .divider { height: 1px; background: #eee; margin: .75rem 0 0 0; }
  </style>
</head>
<body>
  <h1>Paul Bickford Solutions • Advanced Career Mastery</h1>
  <p class="muted">Hello, I’m your ACM TA. I’ll personalize your first 90 days by using your inputs below. You can opt out of any step.</p>

  <!-- 1) Consent -->
  <div class="card" id="card-consent">
    <h2>Consent</h2>
    <label><input type="checkbox" id="consentSite" /> I consent to the TA using my personal website to tailor my learning plan.</label>
    <label><input type="checkbox" id="consentLinkedIn" /> I consent to the TA using my LinkedIn data (I will paste sections or provide a URL).</label>
    <label><input type="checkbox" id="consentJD" /> I consent to the TA storing my new job description for personalization.</label>
  </div>

  <!-- 2) Links & Profile -->
  <div class="card" id="card-profile">
    <h2>Your Links & Profile</h2>
    <label>Personal Website URL(s)</label>
    <textarea id="siteUrls" rows="2" placeholder="https://example.com, https://me.example.org"></textarea>

    <label>LinkedIn Profile URL or Pasted Sections</label>
    <textarea id="linkedin" rows="4" placeholder="Paste About/Experience or your profile URL"></textarea>

    <label>New Job Description (paste)</label>
    <textarea id="jobDesc" rows="6" placeholder="Paste JD here"></textarea>

    <label>Optional: Your top 2–3 outcomes for Day 90</label>
    <textarea id="outcomes" rows="3" placeholder="e.g., Hire 2 key roles; stabilize monthly reporting; launch customer steering committee"></textarea>
  </div>

  <!-- 3) Primary CTA: Transition Risk Assessment -->
  <div class="card" id="card-primary-cta">
    <div class="stack">
      <button class="btn" id="save">Save &amp; Continue to Transition Risk Assessment</button>
    </div>
    <p class="muted" style="margin-top:.5rem;">
      We’ll only use your inputs to personalize weekly exercises, your plan, and check-ins.
    </p>
  </div>
<div class="card" id="nextUpCard" style="display:none;">
  <h2>Next up</h2>
  <div id="nextUpList"></div>
</div>

<script>
  // Utility: make a consistent button style (primary vs secondary)
  function makeBtn(label, href, primary=false) {
    const a = document.createElement('a');
    a.href = href;
    a.textContent = label;
    a.style.display = 'inline-block';
    a.style.padding = '0.6rem 1rem';
    a.style.borderRadius = '10px';
    a.style.border = '1px solid #333';
    a.style.marginRight = '.5rem';
    a.style.textDecoration = 'none';
    if (primary) {
      a.style.background = '#111';
      a.style.color = '#fff';
    } else {
      a.style.background = '#fff';
      a.style.color = '#111';
    }
    return a;
  }

  async function loadNextUp() {
    try {
      const res = await fetch('exercises/manifest.json', { cache: 'no-store' });
      if (!res.ok) throw new Error('Failed to load manifest');
      const manifest = await res.json();
      const items = (manifest.items || [])
        .filter(it => it.enabled !== false)
        .sort((a,b) => (a.order ?? 999) - (b.order ?? 999));

      const wrap = document.getElementById('nextUpList');
      wrap.innerHTML = '';

      items.forEach((it, idx) => {
        const container = document.createElement('div');
        container.style.marginBottom = '.75rem';

        const title = document.createElement('div');
        title.style.fontWeight = '600';
        title.style.marginBottom = '.25rem';
        title.textContent = it.title;

        const desc = document.createElement('div');
        desc.style.color = '#555';
        desc.style.marginBottom = '.5rem';
        desc.textContent = it.description || '';

        const isPrimary = idx === 0; // first item highlighted like the main CTA
        const href = it.type === 'tool' ? it.path : 'tra.html'; 
        // For JSON-defined exercises you may navigate to a dedicated page (e.g., tra.html).
        // If you build a generic renderer later, point to that instead.

        const btn = makeBtn(isPrimary ? `Start: ${it.title}` : `Open: ${it.title}`, href, isPrimary);

        container.appendChild(title);
        container.appendChild(desc);
        container.appendChild(btn);
        wrap.appendChild(container);
      });

      if (items.length) {
        document.getElementById('nextUpCard').style.display = 'block';
      }
    } catch (e) {
      console.warn('Next up list unavailable:', e);
    }
  }

  // Ensure this runs AFTER your existing code that wires up the Save button
  document.addEventListener('DOMContentLoaded', loadNextUp);
</script>

  <!-- 4) Assessments & Tools (this section is BELOW the primary CTA) -->
  <div class="card" id="card-tools">
    <h2>Assessments &amp; Tools</h2>
    <p class="muted">After you complete the Transition Risk Assessment, you can explore additional tools. More items will appear here over time.</p>
    <div class="divider"></div>
    <div class="stack" style="margin-top:.75rem;">
      <!-- Secondary tool button: Break-Even Point visualization -->
      <button class="btn btn-secondary" id="openBEP" disabled>Open Break-Even Point Visualization</button>
    </div>
    <p class="muted" id="toolsHint" style="margin-top:.5rem;">(Complete the Transition Risk Assessment first to unlock additional tools.)</p>
  </div>

  <script>
    // Enable/disable tools depending on whether the intro was saved
    function setToolsAvailability() {
      const savedInit = localStorage.getItem('acm_init_v1');
      const bepBtn = document.getElementById('openBEP');
      const hint = document.getElementById('toolsHint');
      if (savedInit) {
        bepBtn.disabled = false;
        hint.textContent = "You can open the Break-Even Point tool anytime.";
      } else {
        bepBtn.disabled = true;
        hint.textContent = "(Complete the Transition Risk Assessment first to unlock additional tools.)";
      }
    }

    // Primary CTA: Save profile & go to TRA
    document.getElementById('save').addEventListener('click', () => {
      const payload = {
        consents: {
          use_personal_site: document.getElementById('consentSite').checked,
          use_linkedin: document.getElementById('consentLinkedIn').checked,
          store_job_description: document.getElementById('consentJD').checked
        },
        personal_site_urls: document.getElementById('siteUrls').value,
        linkedin: document.getElementById('linkedin').value,
        job_description_text: document.getElementById('jobDesc').value,
        day90_outcomes: document.getElementById('outcomes').value
      };
      localStorage.setItem('acm_init_v1', JSON.stringify(payload));
      // Navigate to Transition Risk Assessment (kept as the first step)
      window.location.href = 'tra.html';
    });

    // Secondary tool button: Break-Even Point
    document.getElementById('openBEP').addEventListener('click', () => {
      window.location.href = 'breakeven.html';
    });

    // On load, set availability of tools
    setToolsAvailability();

    // (Optional) If you want the BEP tool to auto-unlock when user returns from tra.html,
    // this will already work because acm_init_v1 is set before navigation.
  </script>
</body>
</html>
